{"ast":null,"code":"import React,{useState,useRef}from'react';import GeminiService from'../utils/geminiService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatInput=_ref=>{let{onNewQuestion,setIsLoading}=_ref;const[question,setQuestion]=useState('');const fileInputRef=useRef(null);const[attachedFile,setAttachedFile]=useState(null);const handleFileChange=e=>{const file=e.target.files[0];if(file){// Validate file type and size\nconst allowedTypes=['image/jpeg','image/png','image/gif','application/pdf'];const maxSize=5*1024*1024;// 5MB\nif(allowedTypes.includes(file.type)&&file.size<=maxSize){setAttachedFile(file);}else{alert('Please upload a valid image (JPEG, PNG, GIF) or PDF under 5MB');e.target.value=null;}}};const handleFileRemove=()=>{setAttachedFile(null);if(fileInputRef.current){fileInputRef.current.value=null;}};const handleSubmit=async e=>{e.preventDefault();if(!question.trim()&&!attachedFile)return;setIsLoading(true);try{let result;if(attachedFile){// Handle file upload logic\nconst fileContent=await readFileAsBase64(attachedFile);result=await GeminiService.generateAnswer(`Analyze this file: ${fileContent}. Question: ${question}`);}else{result=await GeminiService.generateAnswer(question);}if(result.success){onNewQuestion(question,result.answer);// Reset file after successful submission\nhandleFileRemove();}else{const errorMessage=result.error||\"An unexpected error occurred while processing your request.\";console.error(\"Gemini API Error:\",errorMessage);onNewQuestion(question,errorMessage);}}catch(error){console.error(\"Unexpected Error:\",error);const userFriendlyMessage=error.message.includes('API key')?\"Invalid or missing API key. Please check your configuration.\":error.message.includes('network')?\"Network error. Please check your internet connection.\":\"An unexpected error occurred. Please try again later.\";onNewQuestion(question,userFriendlyMessage);}finally{setIsLoading(false);setQuestion('');}};// Utility function to read file as Base64\nconst readFileAsBase64=file=>{return new Promise((resolve,reject)=>{const reader=new FileReader();reader.readAsDataURL(file);reader.onload=()=>resolve(reader.result);reader.onerror=error=>reject(error);});};return/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,className:\"mt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleFileChange,className:\"hidden\",accept:\"image/jpeg,image/png,image/gif,application/pdf\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>fileInputRef.current.click(),className:\"mr-2 p-2 bg-gray-200 dark:bg-gray-700 rounded-l-lg \\r hover:bg-gray-300 dark:hover:bg-gray-600 \\r transition-colors duration-300\",\"aria-label\":\"Attach File\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6 text-gray-600 dark:text-gray-300\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\"})})}),attachedFile&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded mr-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm mr-2 text-gray-600 dark:text-gray-300\",children:attachedFile.name}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleFileRemove,className:\"text-red-500 hover:text-red-700\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:question,onChange:e=>setQuestion(e.target.value),placeholder:\"Ask a question...\",className:\"flex-grow px-4 py-2 border dark:border-gray-600 \\r focus:outline-none focus:ring-2 focus:ring-blue-500 \\r dark:bg-gray-700\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-500 hover:bg-blue-600 text-white \\r px-4 py-2 rounded-r-lg transition-colors\",children:\"Send\"})]})});};export default ChatInput;","map":{"version":3,"names":["React","useState","useRef","GeminiService","jsx","_jsx","jsxs","_jsxs","ChatInput","_ref","onNewQuestion","setIsLoading","question","setQuestion","fileInputRef","attachedFile","setAttachedFile","handleFileChange","e","file","target","files","allowedTypes","maxSize","includes","type","size","alert","value","handleFileRemove","current","handleSubmit","preventDefault","trim","result","fileContent","readFileAsBase64","generateAnswer","success","answer","errorMessage","error","console","userFriendlyMessage","message","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","onerror","onSubmit","className","children","ref","onChange","accept","onClick","click","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","name","placeholder"],"sources":["C:/Users/ajays/Desktop/ChatwithAjay/src/components/ChatInput.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport GeminiService from '../utils/geminiService';\r\n\r\nconst ChatInput = ({ onNewQuestion, setIsLoading }) => {\r\n  const [question, setQuestion] = useState('');\r\n  const fileInputRef = useRef(null);\r\n  const [attachedFile, setAttachedFile] = useState(null);\r\n\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      // Validate file type and size\r\n      const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/pdf'];\r\n      const maxSize = 5 * 1024 * 1024; // 5MB\r\n\r\n      if (allowedTypes.includes(file.type) && file.size <= maxSize) {\r\n        setAttachedFile(file);\r\n      } else {\r\n        alert('Please upload a valid image (JPEG, PNG, GIF) or PDF under 5MB');\r\n        e.target.value = null;\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFileRemove = () => {\r\n    setAttachedFile(null);\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = null;\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!question.trim() && !attachedFile) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      let result;\r\n      if (attachedFile) {\r\n        // Handle file upload logic\r\n        const fileContent = await readFileAsBase64(attachedFile);\r\n        result = await GeminiService.generateAnswer(\r\n          `Analyze this file: ${fileContent}. Question: ${question}`\r\n        );\r\n      } else {\r\n        result = await GeminiService.generateAnswer(question);\r\n      }\r\n      \r\n      if (result.success) {\r\n        onNewQuestion(question, result.answer);\r\n        // Reset file after successful submission\r\n        handleFileRemove();\r\n      } else {\r\n        const errorMessage = result.error || \r\n          \"An unexpected error occurred while processing your request.\";\r\n        \r\n        console.error(\"Gemini API Error:\", errorMessage);\r\n        \r\n        onNewQuestion(question, errorMessage);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Unexpected Error:\", error);\r\n      \r\n      const userFriendlyMessage = \r\n        error.message.includes('API key') \r\n          ? \"Invalid or missing API key. Please check your configuration.\" \r\n          : error.message.includes('network')\r\n          ? \"Network error. Please check your internet connection.\"\r\n          : \"An unexpected error occurred. Please try again later.\";\r\n      \r\n      onNewQuestion(question, userFriendlyMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n      setQuestion('');\r\n    }\r\n  };\r\n\r\n  // Utility function to read file as Base64\r\n  const readFileAsBase64 = (file) => {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      reader.onload = () => resolve(reader.result);\r\n      reader.onerror = (error) => reject(error);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"mt-4\">\r\n      <div className=\"flex items-center\">\r\n        {/* File Input */}\r\n        <input\r\n          type=\"file\"\r\n          ref={fileInputRef}\r\n          onChange={handleFileChange}\r\n          className=\"hidden\"\r\n          accept=\"image/jpeg,image/png,image/gif,application/pdf\"\r\n        />\r\n        \r\n        {/* File Attachment Button */}\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => fileInputRef.current.click()}\r\n          className=\"mr-2 p-2 bg-gray-200 dark:bg-gray-700 rounded-l-lg \r\n                     hover:bg-gray-300 dark:hover:bg-gray-600 \r\n                     transition-colors duration-300\"\r\n          aria-label=\"Attach File\"\r\n        >\r\n          <svg \r\n            xmlns=\"http://www.w3.org/2000/svg\" \r\n            className=\"h-6 w-6 text-gray-600 dark:text-gray-300\" \r\n            fill=\"none\" \r\n            viewBox=\"0 0 24 24\" \r\n            stroke=\"currentColor\"\r\n          >\r\n            <path \r\n              strokeLinecap=\"round\" \r\n              strokeLinejoin=\"round\" \r\n              strokeWidth={2} \r\n              d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" \r\n            />\r\n          </svg>\r\n        </button>\r\n\r\n        {/* Attached File Display */}\r\n        {attachedFile && (\r\n          <div className=\"flex items-center bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded mr-2\">\r\n            <span className=\"text-sm mr-2 text-gray-600 dark:text-gray-300\">\r\n              {attachedFile.name}\r\n            </span>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleFileRemove}\r\n              className=\"text-red-500 hover:text-red-700\"\r\n            >\r\n              âœ•\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Text Input */}\r\n        <input\r\n          type=\"text\"\r\n          value={question}\r\n          onChange={(e) => setQuestion(e.target.value)}\r\n          placeholder=\"Ask a question...\"\r\n          className=\"flex-grow px-4 py-2 border dark:border-gray-600 \r\n                     focus:outline-none focus:ring-2 focus:ring-blue-500 \r\n                     dark:bg-gray-700\"\r\n        />\r\n\r\n        {/* Send Button */}\r\n        <button\r\n          type=\"submit\"\r\n          className=\"bg-blue-500 hover:bg-blue-600 text-white \r\n                     px-4 py-2 rounded-r-lg transition-colors\"\r\n        >\r\n          Send\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default ChatInput;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}